- name: Install clusterha packages
  become: true
  yum:
    name:
      - pcs
      - fence-agents-all
    state: present

- name: set hacluster password
  become: true
  user: 
    name: hacluster
    password: "$6$redhat$l.NNwn3YXybGpYulm43xTMhs4X1ZUZBx7LfyQwTTnWuEP/JM22H8IV9YWULYZ9S1jbqjW0RTx86DuEmINWI2b/"


- name: set hacluster auth
  become: true
  shell:  pcs cluster auth nodea.example.com nodeb.example.com nodec.example.com -u hacluster -p redhat

- name: setup cluster
  become: true
  shell: pcs cluster setup --start --name mycluster nodea.example.com nodeb.example.com nodec.example.com

- name: enable pcs cluster
  become: true
  shell: pcs cluster enable --all

- name: Enable and start pcsd service
  service:  
    name: pcsd
    enabled: yes    
    state: started

