- name: Install clusterha packages
  become: true
  yum:
    name:
      - pcs
      - fence-agents-all
    state: present

- name: set hacluster password
  become: true
  user: 
    name: hacluster
    password: "{{ 'redhat' | password_hash('sha512', 'mysecretsalt') }}"

- name: set hacluster auth
  become: true
  shell:  pcs cluster auth nodea.example.com nodeb.example.com nodec.example.com -u hacluster -p redhat

- name: setup cluster
  become: true
  shell: pcs cluster setup --start --name mycluster nodea.example.com nodeb.example.com nodec.example.com

- name: enable pcs cluster
  become: true
  shell: pcs cluster enable --all

- name: Enable and start pcsd service
  service:  
    name: pcsd
    enabled: yes    
    state: started

